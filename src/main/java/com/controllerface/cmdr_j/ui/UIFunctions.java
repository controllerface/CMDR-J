package com.controllerface.cmdr_j.ui;

import com.controllerface.cmdr_j.ProcurementRecipe;
import com.controllerface.cmdr_j.data.ItemEffectData;
import com.controllerface.cmdr_j.data.commander.InventoryData;
import com.controllerface.cmdr_j.data.procurements.CostData;
import com.controllerface.cmdr_j.data.procurements.ItemCostData;
import com.controllerface.cmdr_j.data.procurements.ProcurementTaskData;
import com.controllerface.cmdr_j.structures.equipment.ItemEffect;
import com.controllerface.cmdr_j.structures.equipment.ItemGrade;
import com.controllerface.cmdr_j.threads.UserTransaction;
import javafx.beans.property.SimpleStringProperty;
import javafx.beans.value.ObservableValue;
import javafx.geometry.Insets;
import javafx.geometry.Pos;
import javafx.scene.control.*;
import javafx.scene.layout.Region;
import javafx.scene.paint.Color;
import javafx.scene.shape.SVGPath;
import javafx.scene.text.Font;
import javafx.scene.text.FontWeight;
import javafx.util.Callback;
import javafx.util.Pair;

import java.math.BigDecimal;
import java.math.RoundingMode;
import java.nio.charset.StandardCharsets;
import java.util.Comparator;
import java.util.EnumMap;
import java.util.function.Function;

/**
 * This class stores several stateless functions and utility objects that are used to build or modify the GUI. These
 * functions are stored here in an effort to keep the UI controller classes and various custom cell/display object
 * classes from getting too cluttered with support functions.
 *
 * This class in organized such that related functionality resides within inner static classes of a common name,
 * for example the Data subclass houses various cell and cell data functions used to define how various table cells
 * are created or displayed.
 *
 * Created by Controllerface on 4/19/2018.
 */
public class UIFunctions
{
    public static final int scrollBarAllowance = 20;

    public static final EnumMap<UserTransaction.MessageType, Color> messageColors =
            new EnumMap<>(UserTransaction.MessageType.class);
    static
    {
        for (UserTransaction.MessageType messageType : UserTransaction.MessageType.values())
        {
            Color color;
            switch (messageType)
            {
                case GENERAL: color = Color.DARKCYAN;
                    break;

                case INVENTORY: color = Color.DARKBLUE;
                    break;

                case LOADOUT: color = Color.DARKORCHID;
                    break;

                case ENGINEERING: color = Color.DARKORANGE;
                    break;

                case COMBAT: color = Color.DARKRED;
                    break;

                case TRAVEL: color = Color.DARKMAGENTA;
                    break;

                default: color = Color.BLACK;
                    break;
            }
            messageColors.put(messageType, color);
        }
    }

    public static class Symbols
    {
        public static final String DEGREES = new String(new byte[]{(byte)0x00,(byte)0xb0}, StandardCharsets.UTF_16);
        public static final String INFINITY = new String(new byte[]{(byte)0x22,(byte)0x1e}, StandardCharsets.UTF_16);
    }

    public static class Fonts
    {
        public static final Color positiveBlue = Color.rgb(0x00, 0xb3, 0xf7);
        public static final Color negativeRed = Color.rgb(0xff, 0x00, 0x00);
        public static final Color neutralBlack = Color.rgb(0x00, 0x00, 0x00);
        //public static final Color standardOrange = Color.rgb(0xff, 0x71, 0x00);
        //public static final Color specialYellow = Color.rgb(0xff, 0xb0, 0x00);
        public static final Color darkOrange = Color.rgb(0xb7, 0x52, 0x00);
        public static final Color darkYellow = Color.rgb(0xb7, 0x7d, 0x00);

        static final Font baseFont = Font.getDefault();
        static final double size1 = baseFont.getSize() + (baseFont.getSize() / 5);
        static final double size2 = baseFont.getSize() + (baseFont.getSize() / 4);
        static final double size3 = baseFont.getSize() + (baseFont.getSize() / 3);
        static final double size4 = baseFont.getSize() + (baseFont.getSize() / 2);

        //public static final Font size0Font = Font.font(baseFont.getFamily(), FontWeight.BOLD, baseFont.getSize());
        public static final Font size1Font = Font.font(baseFont.getFamily(), FontWeight.BOLD, size1);
        public static final Font size2Font = Font.font(baseFont.getFamily(), FontWeight.BOLD, size2);
        public static final Font size3Font = Font.font(baseFont.getFamily(), FontWeight.BOLD, size3);
        public static final Font size4Font = Font.font(baseFont.getFamily(), FontWeight.BOLD, size4);
    }

    public static class Icons
    {
        public static final SVGPath cargo = new SVGPath();
        public static final SVGPath materialGrade1 = new SVGPath();
        public static final SVGPath materialGrade2 = new SVGPath();
        public static final SVGPath materialGrade3 = new SVGPath();
        public static final SVGPath materialGrade4 = new SVGPath();
        public static final SVGPath materialGrade5 = new SVGPath();

        // These are Hard-Coded SCG paths
        static
        {
            cargo.setContent("M 636.31,438.00\n" +
                    "           C 636.31,438.00 656.26,481.00 656.26,481.00\n" +
                    "             656.26,481.00 665.22,500.00 665.22,500.00\n" +
                    "             666.35,502.40 668.32,506.34 667.90,509.00\n" +
                    "             667.46,511.80 662.82,517.45 661.00,520.00\n" +
                    "             661.00,520.00 642.00,546.00 642.00,546.00\n" +
                    "             642.00,546.00 616.42,581.00 616.42,581.00\n" +
                    "             613.30,585.33 604.09,598.66 600.83,601.47\n" +
                    "             600.83,601.47 577.00,615.42 577.00,615.42\n" +
                    "             577.00,615.42 531.00,641.58 531.00,641.58\n" +
                    "             531.00,641.58 498.00,660.42 498.00,660.42\n" +
                    "             491.05,664.40 485.17,668.89 477.00,669.00\n" +
                    "             477.00,669.00 447.00,667.09 447.00,667.09\n" +
                    "             447.00,667.09 387.00,663.04 387.00,663.04\n" +
                    "             387.00,663.04 378.00,663.04 378.00,663.04\n" +
                    "             378.00,663.04 367.00,662.00 367.00,662.00\n" +
                    "             363.83,661.98 359.19,662.31 356.64,660.18\n" +
                    "             354.61,658.49 348.42,644.29 347.00,641.00\n" +
                    "             347.00,641.00 328.14,600.00 328.14,600.00\n" +
                    "             328.14,600.00 306.31,553.00 306.31,553.00\n" +
                    "             306.31,553.00 261.69,456.00 261.69,456.00\n" +
                    "             261.69,456.00 195.69,313.00 195.69,313.00\n" +
                    "             195.69,313.00 177.69,274.00 177.69,274.00\n" +
                    "             177.69,274.00 164.46,245.00 164.46,245.00\n" +
                    "             164.46,245.00 159.33,229.00 159.33,229.00\n" +
                    "             159.33,229.00 143.00,178.00 143.00,178.00\n" +
                    "             141.39,173.11 135.17,155.95 135.31,152.00\n" +
                    "             135.48,147.31 142.92,138.94 145.87,135.00\n" +
                    "             145.87,135.00 175.13,96.00 175.13,96.00\n" +
                    "             175.13,96.00 195.29,69.00 195.29,69.00\n" +
                    "             197.95,65.28 205.01,55.08 208.17,52.70\n" +
                    "             208.17,52.70 231.00,42.58 231.00,42.58\n" +
                    "             231.00,42.58 283.00,20.72 283.00,20.72\n" +
                    "             283.00,20.72 316.00,6.72 316.00,6.72\n" +
                    "             320.23,4.89 329.86,0.46 334.00,0.11\n" +
                    "             339.31,-0.35 359.43,3.81 366.00,4.92\n" +
                    "             366.00,4.92 432.00,16.25 432.00,16.25\n" +
                    "             440.63,17.81 441.56,22.64 445.25,30.00\n" +
                    "             445.25,30.00 458.75,57.00 458.75,57.00\n" +
                    "             458.75,57.00 509.69,164.00 509.69,164.00\n" +
                    "             509.69,164.00 520.74,188.00 520.74,188.00\n" +
                    "             522.16,190.94 524.06,196.44 526.39,198.42\n" +
                    "             528.13,199.89 530.83,200.39 533.00,201.00\n" +
                    "             532.27,206.44 537.36,218.38 540.33,222.99\n" +
                    "             540.33,222.99 546.00,231.00 546.00,231.00\n" +
                    "             546.00,231.00 541.00,231.00 541.00,231.00\n" +
                    "             541.00,231.00 565.22,284.00 565.22,284.00\n" +
                    "             565.22,284.00 595.24,349.00 595.24,349.00\n" +
                    "             595.24,349.00 606.76,374.00 606.76,374.00\n" +
                    "             606.76,374.00 611.84,382.80 611.84,382.80\n" +
                    "             611.84,382.80 620.00,382.80 620.00,382.80\n" +
                    "             619.11,384.71 618.96,386.15 617.00,385.00\n" +
                    "             617.00,385.00 614.00,387.00 614.00,387.00\n" +
                    "             614.00,387.00 620.00,403.00 620.00,403.00\n" +
                    "             620.00,403.00 622.00,402.00 622.00,402.00\n" +
                    "             622.00,402.00 623.00,405.00 623.00,405.00\n" +
                    "             623.00,405.00 629.00,407.00 629.00,407.00\n" +
                    "             629.00,407.00 631.00,410.00 631.00,410.00\n" +
                    "             631.00,410.00 630.00,412.00 630.00,412.00\n" +
                    "             630.00,412.00 632.00,414.00 632.00,414.00\n" +
                    "             632.00,414.00 625.00,414.00 625.00,414.00\n" +
                    "             625.00,414.00 636.31,438.00 636.31,438.00 Z\n" +
                    "           M 206.00,219.83\n" +
                    "           C 206.00,219.83 246.00,223.09 246.00,223.09\n" +
                    "             246.00,223.09 269.00,224.82 269.00,224.82\n" +
                    "             269.00,224.82 298.00,214.20 298.00,214.20\n" +
                    "             298.00,214.20 347.00,194.68 347.00,194.68\n" +
                    "             347.00,194.68 380.96,180.93 380.96,180.93\n" +
                    "             385.10,178.34 387.13,173.99 389.69,170.00\n" +
                    "             389.69,170.00 405.05,146.00 405.05,146.00\n" +
                    "             405.05,146.00 431.34,105.00 431.34,105.00\n" +
                    "             433.59,101.54 442.07,89.23 442.37,86.00\n" +
                    "             442.65,83.13 440.51,79.53 439.25,77.00\n" +
                    "             439.25,77.00 430.75,60.00 430.75,60.00\n" +
                    "             428.66,55.82 423.27,43.27 419.79,41.17\n" +
                    "             417.64,39.87 410.79,39.05 408.00,38.59\n" +
                    "             408.00,38.59 386.00,34.75 386.00,34.75\n" +
                    "             386.00,34.75 353.00,29.08 353.00,29.08\n" +
                    "             348.40,28.32 340.34,26.58 336.00,27.21\n" +
                    "             332.13,27.78 318.52,34.08 314.00,36.00\n" +
                    "             314.00,36.00 270.00,54.58 270.00,54.58\n" +
                    "             270.00,54.58 241.00,66.99 241.00,66.99\n" +
                    "             237.12,68.59 227.13,72.33 224.30,74.65\n" +
                    "             221.63,76.83 216.98,83.85 214.63,87.00\n" +
                    "             214.63,87.00 195.13,113.00 195.13,113.00\n" +
                    "             195.13,113.00 173.63,142.00 173.63,142.00\n" +
                    "             171.53,144.80 164.77,153.25 163.95,156.00\n" +
                    "             162.91,159.51 167.32,170.15 168.69,174.00\n" +
                    "             168.69,174.00 184.00,218.00 184.00,218.00\n" +
                    "             184.00,218.00 206.00,219.83 206.00,219.83 Z\n" +
                    "           M 234.63,139.00\n" +
                    "           C 233.65,135.08 231.47,128.83 232.74,125.00\n" +
                    "             233.85,121.67 243.41,109.62 246.13,106.00\n" +
                    "             249.26,101.82 258.96,88.20 262.17,85.64\n" +
                    "             265.52,82.96 277.41,78.50 282.00,76.58\n" +
                    "             287.44,74.29 308.81,64.61 313.00,64.30\n" +
                    "             313.00,64.30 331.00,66.92 331.00,66.92\n" +
                    "             331.00,66.92 349.00,70.08 349.00,70.08\n" +
                    "             351.57,70.51 355.40,70.82 357.37,72.59\n" +
                    "             359.51,74.52 367.82,92.13 369.75,96.00\n" +
                    "             370.93,98.36 373.29,102.40 373.11,105.00\n" +
                    "             372.91,107.71 367.65,115.31 365.95,118.00\n" +
                    "             365.95,118.00 352.42,139.00 352.42,139.00\n" +
                    "             350.10,142.72 346.08,149.76 342.82,152.35\n" +
                    "             339.86,154.71 326.36,159.65 322.00,161.40\n" +
                    "             322.00,161.40 293.00,172.31 293.00,172.31\n" +
                    "             293.00,172.31 262.00,171.00 262.00,171.00\n" +
                    "             262.00,171.00 242.00,170.00 242.00,170.00\n" +
                    "             242.00,170.00 234.63,139.00 234.63,139.00 Z\n" +
                    "           M 300.00,96.58\n" +
                    "           C 295.32,98.54 281.41,103.85 278.17,106.49\n" +
                    "             275.80,108.43 272.32,113.37 270.42,116.00\n" +
                    "             268.13,119.18 260.42,128.90 259.86,132.00\n" +
                    "             259.49,134.02 260.36,136.99 260.87,139.00\n" +
                    "             261.47,141.31 261.91,144.26 264.30,145.40\n" +
                    "             265.51,145.98 277.04,146.97 279.00,147.00\n" +
                    "             293.61,147.17 298.73,143.31 312.00,138.00\n" +
                    "             315.57,136.57 323.93,133.66 326.47,131.35\n" +
                    "             328.43,129.58 330.80,125.36 332.34,123.00\n" +
                    "             334.47,119.75 343.31,106.85 343.77,104.00\n" +
                    "             344.20,101.36 342.26,97.35 340.37,95.56\n" +
                    "             337.42,92.78 320.52,90.60 316.00,90.49\n" +
                    "             310.49,91.48 305.16,94.41 300.00,96.58 Z\n" +
                    "           M 444.00,133.00\n" +
                    "           C 444.00,133.00 418.34,173.00 418.34,173.00\n" +
                    "             415.53,177.30 405.46,191.71 405.60,196.00\n" +
                    "             405.69,198.74 408.49,204.42 409.76,207.00\n" +
                    "             409.76,207.00 419.75,227.00 419.75,227.00\n" +
                    "             419.75,227.00 452.74,295.00 452.74,295.00\n" +
                    "             452.74,295.00 547.74,491.00 547.74,491.00\n" +
                    "             547.74,491.00 575.75,549.00 575.75,549.00\n" +
                    "             579.06,555.62 584.44,569.43 589.00,574.00\n" +
                    "             589.00,574.00 623.37,527.00 623.37,527.00\n" +
                    "             623.37,527.00 637.37,506.00 637.37,506.00\n" +
                    "             637.37,506.00 634.22,496.00 634.22,496.00\n" +
                    "             634.22,496.00 624.86,476.00 624.86,476.00\n" +
                    "             624.86,476.00 588.78,398.00 588.78,398.00\n" +
                    "             588.78,398.00 554.69,324.00 554.69,324.00\n" +
                    "             554.69,324.00 494.31,194.00 494.31,194.00\n" +
                    "             494.31,194.00 457.00,114.00 457.00,114.00\n" +
                    "             452.14,119.22 447.96,126.92 444.00,133.00 Z\n" +
                    "           M 528.00,202.00\n" +
                    "           C 528.00,202.00 529.00,203.00 529.00,203.00\n" +
                    "             529.00,203.00 529.00,202.00 529.00,202.00\n" +
                    "             529.00,202.00 528.00,202.00 528.00,202.00 Z\n" +
                    "           M 529.00,204.00\n" +
                    "           C 529.00,204.00 530.00,205.00 530.00,205.00\n" +
                    "             530.00,205.00 530.00,204.00 530.00,204.00\n" +
                    "             530.00,204.00 529.00,204.00 529.00,204.00 Z\n" +
                    "           M 534.00,215.00\n" +
                    "           C 534.00,215.00 532.00,208.00 532.00,208.00\n" +
                    "             531.17,211.34 531.99,212.35 534.00,215.00 Z\n" +
                    "           M 282.00,248.00\n" +
                    "           C 282.00,248.00 298.75,284.00 298.75,284.00\n" +
                    "             298.75,284.00 329.74,347.00 329.74,347.00\n" +
                    "             329.74,347.00 427.75,548.00 427.75,548.00\n" +
                    "             427.75,548.00 462.25,619.00 462.25,619.00\n" +
                    "             462.25,619.00 470.69,636.00 470.69,636.00\n" +
                    "             470.69,636.00 475.22,642.13 475.22,642.13\n" +
                    "             475.22,642.13 483.00,639.15 483.00,639.15\n" +
                    "             483.00,639.15 500.00,629.28 500.00,629.28\n" +
                    "             500.00,629.28 543.00,604.58 543.00,604.58\n" +
                    "             543.00,604.58 567.00,591.00 567.00,591.00\n" +
                    "             567.00,591.00 533.26,521.00 533.26,521.00\n" +
                    "             533.26,521.00 469.26,389.00 469.26,389.00\n" +
                    "             469.26,389.00 406.26,259.00 406.26,259.00\n" +
                    "             406.26,259.00 390.26,226.00 390.26,226.00\n" +
                    "             390.26,226.00 382.00,209.00 382.00,209.00\n" +
                    "             382.00,209.00 282.00,248.00 282.00,248.00 Z\n" +
                    "           M 535.00,218.00\n" +
                    "           C 535.00,218.00 536.00,219.00 536.00,219.00\n" +
                    "             536.00,219.00 536.00,218.00 536.00,218.00\n" +
                    "             536.00,218.00 535.00,218.00 535.00,218.00 Z\n" +
                    "           M 417.26,586.00\n" +
                    "           C 417.26,586.00 352.74,453.00 352.74,453.00\n" +
                    "             352.74,453.00 331.75,410.00 331.75,410.00\n" +
                    "             331.75,410.00 316.31,379.00 316.31,379.00\n" +
                    "             316.31,379.00 290.75,326.00 290.75,326.00\n" +
                    "             290.75,326.00 275.86,296.00 275.86,296.00\n" +
                    "             275.86,296.00 260.25,264.00 260.25,264.00\n" +
                    "             259.05,261.60 254.70,252.02 253.30,250.74\n" +
                    "             251.07,248.69 238.56,248.16 235.00,247.97\n" +
                    "             235.00,247.97 217.00,246.17 217.00,246.17\n" +
                    "             217.00,246.17 193.00,244.00 193.00,244.00\n" +
                    "             193.00,244.00 214.69,291.00 214.69,291.00\n" +
                    "             214.69,291.00 255.69,380.00 255.69,380.00\n" +
                    "             255.69,380.00 302.69,482.00 302.69,482.00\n" +
                    "             302.69,482.00 324.74,530.00 324.74,530.00\n" +
                    "             324.74,530.00 359.74,606.00 359.74,606.00\n" +
                    "             359.74,606.00 368.42,625.00 368.42,625.00\n" +
                    "             369.65,627.82 372.04,633.41 374.39,635.26\n" +
                    "             377.59,637.79 386.42,636.82 391.00,637.42\n" +
                    "             391.00,637.42 444.00,641.00 444.00,641.00\n" +
                    "             444.00,641.00 417.26,586.00 417.26,586.00 Z\n" +
                    "           M 614.00,385.00\n" +
                    "           C 614.00,385.00 615.00,386.00 615.00,386.00\n" +
                    "             615.00,386.00 615.00,385.00 615.00,385.00\n" +
                    "             615.00,385.00 614.00,385.00 614.00,385.00 Z\n" +
                    "           M 613.00,386.00\n" +
                    "           C 613.00,386.00 614.00,387.00 614.00,387.00\n" +
                    "             614.00,387.00 614.00,386.00 614.00,386.00\n" +
                    "             614.00,386.00 613.00,386.00 613.00,386.00 Z\n" +
                    "           M 617.00,397.00\n" +
                    "           C 617.00,397.00 618.00,398.00 618.00,398.00\n" +
                    "             618.00,398.00 618.00,397.00 618.00,397.00\n" +
                    "             618.00,397.00 617.00,397.00 617.00,397.00 Z\n" +
                    "           M 621.00,404.00\n" +
                    "           C 621.00,404.00 622.00,405.00 622.00,405.00\n" +
                    "             622.00,405.00 622.00,404.00 622.00,404.00\n" +
                    "             622.00,404.00 621.00,404.00 621.00,404.00 Z\n" +
                    "           M 623.00,406.00\n" +
                    "           C 623.00,406.00 624.00,407.00 624.00,407.00\n" +
                    "             624.00,407.00 624.00,406.00 624.00,406.00\n" +
                    "             624.00,406.00 623.00,406.00 623.00,406.00 Z\n" +
                    "           M 627.00,410.00\n" +
                    "           C 627.00,410.00 628.00,411.00 628.00,411.00\n" +
                    "             628.00,411.00 628.00,410.00 628.00,410.00\n" +
                    "             628.00,410.00 627.00,410.00 627.00,410.00 Z");

            materialGrade1.setContent("M 579.00,2.00\n" +
                    "           C 579.00,2.00 562.95,30.00 562.95,30.00\n" +
                    "             562.95,30.00 555.24,41.43 555.24,41.43\n" +
                    "             555.24,41.43 547.00,43.00 547.00,43.00\n" +
                    "             547.00,43.00 280.00,43.00 280.00,43.00\n" +
                    "             280.00,43.00 271.53,41.40 271.53,41.40\n" +
                    "             271.53,41.40 263.32,29.00 263.32,29.00\n" +
                    "             263.32,29.00 247.00,2.00 247.00,2.00\n" +
                    "             247.00,2.00 579.00,2.00 579.00,2.00 Z\n" +
                    "           M 662.00,44.00\n" +
                    "           C 662.00,44.00 679.58,73.00 679.58,73.00\n" +
                    "             679.58,73.00 704.19,113.00 704.19,113.00\n" +
                    "             704.19,113.00 779.42,236.00 779.42,236.00\n" +
                    "             779.42,236.00 813.20,291.00 813.20,291.00\n" +
                    "             813.20,291.00 828.00,317.00 828.00,317.00\n" +
                    "             828.00,317.00 788.00,317.00 788.00,317.00\n" +
                    "             778.35,316.98 779.02,315.29 771.60,303.00\n" +
                    "             771.60,303.00 749.58,267.00 749.58,267.00\n" +
                    "             749.58,267.00 667.40,133.00 667.40,133.00\n" +
                    "             667.40,133.00 645.95,98.00 645.95,98.00\n" +
                    "             644.03,94.94 638.01,86.19 637.91,83.00\n" +
                    "             637.82,79.97 642.14,73.77 643.80,71.00\n" +
                    "             643.80,71.00 660.00,44.00 660.00,44.00\n" +
                    "             660.00,44.00 662.00,44.00 662.00,44.00 Z\n" +
                    "           M 167.00,45.00\n" +
                    "           C 167.00,45.00 183.60,72.00 183.60,72.00\n" +
                    "             185.31,74.85 189.48,80.82 189.31,84.00\n" +
                    "             189.16,86.90 183.01,95.98 181.20,99.00\n" +
                    "             181.20,99.00 160.32,133.00 160.32,133.00\n" +
                    "             160.32,133.00 87.40,252.00 87.40,252.00\n" +
                    "             87.40,252.00 57.81,300.00 57.81,300.00\n" +
                    "             55.32,304.07 50.05,314.74 45.91,316.40\n" +
                    "             44.12,317.12 40.97,317.00 39.00,317.00\n" +
                    "             39.00,317.00 0.00,317.00 0.00,317.00\n" +
                    "             1.62,310.20 12.10,294.69 16.32,288.00\n" +
                    "             16.32,288.00 48.19,236.00 48.19,236.00\n" +
                    "             48.19,236.00 117.42,123.00 117.42,123.00\n" +
                    "             117.42,123.00 144.42,79.00 144.42,79.00\n" +
                    "             144.42,79.00 165.00,45.00 165.00,45.00\n" +
                    "             165.00,45.00 167.00,45.00 167.00,45.00 Z\n" +
                    "           M 339.66,367.00\n" +
                    "           C 339.66,367.00 348.58,337.00 348.58,337.00\n" +
                    "             348.58,337.00 353.70,322.39 353.70,322.39\n" +
                    "             353.70,322.39 371.00,313.58 371.00,313.58\n" +
                    "             371.00,313.58 407.00,297.70 407.00,297.70\n" +
                    "             407.00,297.70 495.00,258.70 495.00,258.70\n" +
                    "             495.00,258.70 545.00,237.00 545.00,237.00\n" +
                    "             545.00,237.00 544.00,253.00 544.00,253.00\n" +
                    "             544.00,253.00 543.00,276.00 543.00,276.00\n" +
                    "             543.00,276.00 542.00,291.00 542.00,291.00\n" +
                    "             542.00,291.00 540.00,329.00 540.00,329.00\n" +
                    "             540.00,329.00 539.00,344.00 539.00,344.00\n" +
                    "             539.00,344.00 539.00,348.00 539.00,348.00\n" +
                    "             539.00,348.00 538.00,363.00 538.00,363.00\n" +
                    "             538.00,363.00 536.98,371.61 536.98,371.61\n" +
                    "             536.98,371.61 524.00,379.25 524.00,379.25\n" +
                    "             524.00,379.25 489.00,396.22 489.00,396.22\n" +
                    "             489.00,396.22 358.00,459.31 358.00,459.31\n" +
                    "             358.00,459.31 323.00,476.31 323.00,476.31\n" +
                    "             323.00,476.31 305.00,484.00 305.00,484.00\n" +
                    "             305.00,484.00 339.66,367.00 339.66,367.00 Z\n" +
                    "           M 39.00,408.00\n" +
                    "           C 48.90,408.02 47.00,408.21 56.32,423.00\n" +
                    "             56.32,423.00 85.05,470.00 85.05,470.00\n" +
                    "             85.05,470.00 158.05,589.00 158.05,589.00\n" +
                    "             158.05,589.00 178.81,623.00 178.81,623.00\n" +
                    "             180.75,626.16 187.43,635.96 187.77,639.00\n" +
                    "             188.14,642.30 184.43,647.23 182.68,650.00\n" +
                    "             178.24,657.05 169.59,673.26 164.00,678.00\n" +
                    "             164.00,678.00 153.95,662.00 153.95,662.00\n" +
                    "             153.95,662.00 130.58,624.00 130.58,624.00\n" +
                    "             130.58,624.00 51.58,495.00 51.58,495.00\n" +
                    "             51.58,495.00 16.58,438.00 16.58,438.00\n" +
                    "             12.04,430.67 1.46,415.67 0.00,408.00\n" +
                    "             0.00,408.00 39.00,408.00 39.00,408.00 Z\n" +
                    "           M 645.19,651.00\n" +
                    "           C 643.21,647.77 639.30,642.87 639.86,639.00\n" +
                    "             640.32,635.79 647.33,625.43 649.40,622.00\n" +
                    "             649.40,622.00 673.32,583.00 673.32,583.00\n" +
                    "             673.32,583.00 749.40,459.00 749.40,459.00\n" +
                    "             749.40,459.00 771.58,423.00 771.58,423.00\n" +
                    "             780.38,408.79 778.68,408.02 789.00,408.00\n" +
                    "             789.00,408.00 828.00,408.00 828.00,408.00\n" +
                    "             826.62,414.77 818.68,425.69 814.81,432.00\n" +
                    "             814.81,432.00 784.20,482.00 784.20,482.00\n" +
                    "             784.20,482.00 701.42,617.00 701.42,617.00\n" +
                    "             701.42,617.00 676.81,657.00 676.81,657.00\n" +
                    "             672.81,663.52 667.53,674.17 662.00,679.00\n" +
                    "             662.00,679.00 645.19,651.00 645.19,651.00 Z\n" +
                    "           M 261.19,695.00\n" +
                    "           C 261.19,695.00 269.21,684.02 269.21,684.02\n" +
                    "             269.21,684.02 277.00,683.00 277.00,683.00\n" +
                    "             277.00,683.00 551.00,683.00 551.00,683.00\n" +
                    "             551.00,683.00 558.39,683.99 558.39,683.99\n" +
                    "             558.39,683.99 566.05,695.00 566.05,695.00\n" +
                    "             566.05,695.00 582.00,722.00 582.00,722.00\n" +
                    "             582.00,722.00 245.00,722.00 245.00,722.00\n" +
                    "             245.00,722.00 261.19,695.00 261.19,695.00 Z");

            materialGrade2.setContent("M 13.80,290.00\n" +
                    "           C 13.80,290.00 45.19,239.00 45.19,239.00\n" +
                    "             45.19,239.00 148.05,71.00 148.05,71.00\n" +
                    "             148.05,71.00 180.60,18.00 180.60,18.00\n" +
                    "             183.04,13.93 189.07,2.24 193.10,0.60\n" +
                    "             194.87,-0.12 198.05,0.00 200.00,0.00\n" +
                    "             200.00,0.00 628.00,0.00 628.00,0.00\n" +
                    "             629.91,0.00 633.10,-0.12 634.82,0.60\n" +
                    "             638.54,2.16 644.61,14.10 647.05,18.00\n" +
                    "             647.05,18.00 680.20,72.00 680.20,72.00\n" +
                    "             680.20,72.00 783.20,240.00 783.20,240.00\n" +
                    "             783.20,240.00 812.05,287.00 812.05,287.00\n" +
                    "             816.21,293.65 826.05,308.32 828.00,315.00\n" +
                    "             828.00,315.00 788.00,315.00 788.00,315.00\n" +
                    "             778.62,314.98 780.52,315.02 772.32,302.00\n" +
                    "             772.32,302.00 751.58,268.00 751.58,268.00\n" +
                    "             751.58,268.00 659.42,118.00 659.42,118.00\n" +
                    "             659.42,118.00 623.32,59.00 623.32,59.00\n" +
                    "             620.58,54.65 614.25,42.34 609.91,40.60\n" +
                    "             608.12,39.88 604.97,40.00 603.00,40.00\n" +
                    "             603.00,40.00 224.00,40.00 224.00,40.00\n" +
                    "             222.12,40.00 218.89,39.88 217.21,40.60\n" +
                    "             213.94,42.00 206.61,55.32 204.40,59.00\n" +
                    "             204.40,59.00 167.60,119.00 167.60,119.00\n" +
                    "             167.60,119.00 76.20,268.00 76.20,268.00\n" +
                    "             76.20,268.00 56.60,300.00 56.60,300.00\n" +
                    "             49.56,311.67 50.08,314.98 39.00,315.00\n" +
                    "             39.00,315.00 0.00,315.00 0.00,315.00\n" +
                    "             1.67,308.02 9.81,296.65 13.80,290.00 Z\n" +
                    "           M 273.58,359.00\n" +
                    "           C 273.58,359.00 305.00,279.00 305.00,279.00\n" +
                    "             305.00,279.00 317.19,248.00 317.19,248.00\n" +
                    "             317.19,248.00 323.65,233.70 323.65,233.70\n" +
                    "             323.65,233.70 341.00,227.00 341.00,227.00\n" +
                    "             341.00,227.00 380.00,213.67 380.00,213.67\n" +
                    "             380.00,213.67 472.00,182.31 472.00,182.31\n" +
                    "             472.00,182.31 521.00,166.00 521.00,166.00\n" +
                    "             521.00,166.00 517.13,198.00 517.13,198.00\n" +
                    "             517.13,198.00 507.73,264.00 507.73,264.00\n" +
                    "             507.73,264.00 503.00,300.00 503.00,300.00\n" +
                    "             503.00,300.00 443.00,322.58 443.00,322.58\n" +
                    "             443.00,322.58 329.00,365.81 329.00,365.81\n" +
                    "             329.00,365.81 287.00,381.81 287.00,381.81\n" +
                    "             287.00,381.81 261.00,391.00 261.00,391.00\n" +
                    "             261.00,391.00 273.58,359.00 273.58,359.00 Z\n" +
                    "           M 336.27,519.00\n" +
                    "           C 336.27,519.00 344.73,460.00 344.73,460.00\n" +
                    "             344.73,460.00 348.58,433.00 348.58,433.00\n" +
                    "             348.58,433.00 351.01,421.50 351.01,421.50\n" +
                    "             351.01,421.50 367.00,414.40 367.00,414.40\n" +
                    "             367.00,414.40 412.00,397.19 412.00,397.19\n" +
                    "             412.00,397.19 532.00,351.58 532.00,351.58\n" +
                    "             532.00,351.58 574.00,335.66 574.00,335.66\n" +
                    "             574.00,335.66 591.00,330.00 591.00,330.00\n" +
                    "             591.00,330.00 575.60,371.00 575.60,371.00\n" +
                    "             575.60,371.00 547.40,443.00 547.40,443.00\n" +
                    "             547.40,443.00 535.60,473.00 535.60,473.00\n" +
                    "             535.60,473.00 529.35,486.49 529.35,486.49\n" +
                    "             529.35,486.49 515.00,492.42 515.00,492.42\n" +
                    "             515.00,492.42 476.00,505.69 476.00,505.69\n" +
                    "             476.00,505.69 397.00,532.69 397.00,532.69\n" +
                    "             397.00,532.69 331.00,555.00 331.00,555.00\n" +
                    "             331.00,555.00 336.27,519.00 336.27,519.00 Z\n" +
                    "           M 39.00,406.00\n" +
                    "           C 48.94,406.02 47.44,406.85 55.05,419.00\n" +
                    "             55.05,419.00 76.00,453.00 76.00,453.00\n" +
                    "             76.00,453.00 168.58,604.00 168.58,604.00\n" +
                    "             168.58,604.00 204.19,662.00 204.19,662.00\n" +
                    "             206.73,666.15 213.19,678.73 217.18,680.40\n" +
                    "             218.91,681.12 222.09,681.00 224.00,681.00\n" +
                    "             224.00,681.00 604.00,681.00 604.00,681.00\n" +
                    "             605.88,681.00 609.11,681.12 610.79,680.40\n" +
                    "             614.07,678.99 621.38,665.69 623.60,662.00\n" +
                    "             623.60,662.00 660.40,602.00 660.40,602.00\n" +
                    "             660.40,602.00 751.80,453.00 751.80,453.00\n" +
                    "             751.80,453.00 772.05,420.00 772.05,420.00\n" +
                    "             780.33,406.79 778.95,406.02 789.00,406.00\n" +
                    "             789.00,406.00 828.00,406.00 828.00,406.00\n" +
                    "             826.32,413.03 818.75,423.41 814.80,430.00\n" +
                    "             814.80,430.00 784.20,480.00 784.20,480.00\n" +
                    "             784.20,480.00 723.42,579.00 723.42,579.00\n" +
                    "             723.42,579.00 679.32,651.00 679.32,651.00\n" +
                    "             679.32,651.00 646.19,705.00 646.19,705.00\n" +
                    "             644.09,708.39 637.72,720.08 634.67,721.43\n" +
                    "             633.07,722.14 629.81,722.00 628.00,722.00\n" +
                    "             628.00,722.00 200.00,722.00 200.00,722.00\n" +
                    "             198.09,722.00 194.90,722.12 193.18,721.40\n" +
                    "             189.49,719.85 183.93,708.79 181.58,705.00\n" +
                    "             181.58,705.00 148.42,651.00 148.42,651.00\n" +
                    "             148.42,651.00 44.19,481.00 44.19,481.00\n" +
                    "             44.19,481.00 15.32,434.00 15.32,434.00\n" +
                    "             11.14,427.36 1.42,413.00 0.00,406.00\n" +
                    "             0.00,406.00 39.00,406.00 39.00,406.00 Z");

            materialGrade3.setContent("M 234.00,0.00\n" +
                    "           C 234.00,0.00 260.00,0.00 260.00,0.00\n" +
                    "             260.00,0.00 350.00,0.00 350.00,0.00\n" +
                    "             350.00,0.00 657.00,0.00 657.00,0.00\n" +
                    "             658.81,0.00 662.07,-0.14 663.67,0.57\n" +
                    "             666.90,2.00 673.99,15.31 676.32,19.00\n" +
                    "             676.32,19.00 713.68,80.00 713.68,80.00\n" +
                    "             713.68,80.00 835.05,278.00 835.05,278.00\n" +
                    "             835.05,278.00 870.05,335.00 870.05,335.00\n" +
                    "             870.05,335.00 879.95,351.00 879.95,351.00\n" +
                    "             881.38,353.28 884.14,357.38 884.37,360.00\n" +
                    "             884.76,364.40 875.98,376.70 873.40,381.00\n" +
                    "             873.40,381.00 840.40,435.00 840.40,435.00\n" +
                    "             840.40,435.00 712.20,644.00 712.20,644.00\n" +
                    "             712.20,644.00 676.00,703.00 676.00,703.00\n" +
                    "             673.89,706.52 666.62,719.33 663.79,720.98\n" +
                    "             661.69,722.21 658.39,722.00 656.00,722.00\n" +
                    "             656.00,722.00 228.00,722.00 228.00,722.00\n" +
                    "             218.86,721.98 220.39,721.96 212.00,708.00\n" +
                    "             212.00,708.00 196.60,683.00 196.60,683.00\n" +
                    "             196.60,683.00 120.58,559.00 120.58,559.00\n" +
                    "             120.58,559.00 34.05,418.00 34.05,418.00\n" +
                    "             34.05,418.00 9.58,378.00 9.58,378.00\n" +
                    "             7.34,374.41 0.63,364.78 0.48,361.00\n" +
                    "             0.36,357.87 2.73,354.55 4.32,352.00\n" +
                    "             4.32,352.00 14.80,335.00 14.80,335.00\n" +
                    "             14.80,335.00 55.32,269.00 55.32,269.00\n" +
                    "             55.32,269.00 93.81,206.00 93.81,206.00\n" +
                    "             93.81,206.00 170.58,81.00 170.58,81.00\n" +
                    "             170.58,81.00 202.40,29.00 202.40,29.00\n" +
                    "             205.94,23.14 216.52,4.77 220.53,0.99\n" +
                    "             224.69,-0.65 229.56,0.00 234.00,0.00 Z\n" +
                    "           M 231.68,60.00\n" +
                    "           C 231.68,60.00 202.32,108.00 202.32,108.00\n" +
                    "             202.32,108.00 173.58,155.00 173.58,155.00\n" +
                    "             173.58,155.00 93.80,285.00 93.80,285.00\n" +
                    "             93.80,285.00 60.68,339.00 60.68,339.00\n" +
                    "             58.20,342.94 48.50,357.28 48.69,361.00\n" +
                    "             48.83,363.97 54.24,372.07 56.00,375.00\n" +
                    "             56.00,375.00 76.81,409.00 76.81,409.00\n" +
                    "             76.81,409.00 151.80,531.00 151.80,531.00\n" +
                    "             151.80,531.00 221.60,645.00 221.60,645.00\n" +
                    "             221.60,645.00 236.40,669.00 236.40,669.00\n" +
                    "             238.12,671.86 241.51,678.40 244.21,679.98\n" +
                    "             246.31,681.21 249.61,681.00 252.00,681.00\n" +
                    "             252.00,681.00 633.00,681.00 633.00,681.00\n" +
                    "             643.07,680.98 641.29,680.41 650.95,665.00\n" +
                    "             650.95,665.00 682.20,614.00 682.20,614.00\n" +
                    "             682.20,614.00 767.58,475.00 767.58,475.00\n" +
                    "             767.58,475.00 798.05,425.00 798.05,425.00\n" +
                    "             798.05,425.00 826.95,378.00 826.95,378.00\n" +
                    "             829.68,373.65 837.25,363.99 835.90,359.00\n" +
                    "             835.90,359.00 820.42,333.00 820.42,333.00\n" +
                    "             820.42,333.00 789.81,283.00 789.81,283.00\n" +
                    "             789.81,283.00 685.60,113.00 685.60,113.00\n" +
                    "             685.60,113.00 651.81,58.00 651.81,58.00\n" +
                    "             649.48,54.20 643.24,42.13 639.68,40.57\n" +
                    "             638.06,39.86 634.82,40.00 633.00,40.00\n" +
                    "             633.00,40.00 369.00,40.00 369.00,40.00\n" +
                    "             369.00,40.00 286.00,40.00 286.00,40.00\n" +
                    "             286.00,40.00 245.21,40.60 245.21,40.60\n" +
                    "             240.71,43.58 234.86,54.95 231.68,60.00 Z\n" +
                    "           M 449.06,96.00\n" +
                    "           C 449.06,96.00 484.19,154.00 484.19,154.00\n" +
                    "             484.19,154.00 496.80,175.00 496.80,175.00\n" +
                    "             496.80,175.00 501.34,185.00 501.34,185.00\n" +
                    "             501.34,185.00 497.42,194.00 497.42,194.00\n" +
                    "             497.42,194.00 488.20,210.00 488.20,210.00\n" +
                    "             488.20,210.00 471.58,239.00 471.58,239.00\n" +
                    "             471.58,239.00 456.00,266.00 456.00,266.00\n" +
                    "             456.00,266.00 490.00,273.00 490.00,273.00\n" +
                    "             490.00,273.00 572.00,290.79 572.00,290.79\n" +
                    "             572.00,290.79 606.00,298.12 606.00,298.12\n" +
                    "             606.00,298.12 619.61,301.85 619.61,301.85\n" +
                    "             619.61,301.85 629.26,318.00 629.26,318.00\n" +
                    "             629.26,318.00 646.86,351.00 646.86,351.00\n" +
                    "             646.86,351.00 693.31,438.00 693.31,438.00\n" +
                    "             693.31,438.00 709.31,468.00 709.31,468.00\n" +
                    "             709.31,468.00 718.00,486.00 718.00,486.00\n" +
                    "             718.00,486.00 700.00,487.00 700.00,487.00\n" +
                    "             700.00,487.00 666.00,487.00 666.00,487.00\n" +
                    "             666.00,487.00 649.00,488.00 649.00,488.00\n" +
                    "             649.00,488.00 613.00,488.00 613.00,488.00\n" +
                    "             613.00,488.00 598.00,489.00 598.00,489.00\n" +
                    "             598.00,489.00 591.00,489.00 591.00,489.00\n" +
                    "             591.00,489.00 583.39,487.98 583.39,487.98\n" +
                    "             583.39,487.98 571.42,469.00 571.42,469.00\n" +
                    "             571.42,469.00 536.00,408.00 536.00,408.00\n" +
                    "             536.00,408.00 507.17,441.00 507.17,441.00\n" +
                    "             507.17,441.00 450.08,504.00 450.08,504.00\n" +
                    "             450.08,504.00 432.02,524.00 432.02,524.00\n" +
                    "             432.02,524.00 423.96,531.96 423.96,531.96\n" +
                    "             423.96,531.96 412.00,531.96 412.00,531.96\n" +
                    "             412.00,531.96 398.00,531.96 398.00,531.96\n" +
                    "             398.00,531.96 383.00,531.00 383.00,531.00\n" +
                    "             383.00,531.00 340.00,530.00 340.00,530.00\n" +
                    "             340.00,530.00 323.00,529.00 323.00,529.00\n" +
                    "             323.00,529.00 308.00,529.00 308.00,529.00\n" +
                    "             308.00,529.00 292.00,528.00 292.00,528.00\n" +
                    "             292.00,528.00 278.00,528.00 278.00,528.00\n" +
                    "             278.00,528.00 262.00,527.00 262.00,527.00\n" +
                    "             262.00,527.00 214.00,526.00 214.00,526.00\n" +
                    "             214.00,526.00 236.14,485.00 236.14,485.00\n" +
                    "             236.14,485.00 264.15,434.00 264.15,434.00\n" +
                    "             264.15,434.00 274.14,416.00 274.14,416.00\n" +
                    "             274.14,416.00 279.39,408.02 279.39,408.02\n" +
                    "             279.39,408.02 287.00,407.00 287.00,407.00\n" +
                    "             287.00,407.00 373.00,407.00 373.00,407.00\n" +
                    "             373.00,407.00 358.28,362.00 358.28,362.00\n" +
                    "             358.28,362.00 350.34,338.00 350.34,338.00\n" +
                    "             350.34,338.00 337.33,297.00 337.33,297.00\n" +
                    "             337.33,297.00 326.67,264.00 326.67,264.00\n" +
                    "             326.67,264.00 322.31,247.00 322.31,247.00\n" +
                    "             322.31,247.00 331.58,230.00 331.58,230.00\n" +
                    "             331.58,230.00 353.32,195.00 353.32,195.00\n" +
                    "             353.32,195.00 405.58,111.00 405.58,111.00\n" +
                    "             405.58,111.00 420.58,87.00 420.58,87.00\n" +
                    "             420.58,87.00 432.00,69.00 432.00,69.00\n" +
                    "             432.00,69.00 449.06,96.00 449.06,96.00 Z\n" +
                    "           M 454.00,268.00\n" +
                    "           C 454.00,268.00 433.42,304.00 433.42,304.00\n" +
                    "             433.42,304.00 398.99,364.00 398.99,364.00\n" +
                    "             398.99,364.00 381.70,394.00 381.70,394.00\n" +
                    "             381.70,394.00 375.00,407.00 375.00,407.00\n" +
                    "             375.00,407.00 535.00,407.00 535.00,407.00\n" +
                    "             535.00,407.00 512.85,367.00 512.85,367.00\n" +
                    "             512.85,367.00 476.58,304.00 476.58,304.00\n" +
                    "             476.58,304.00 456.00,268.00 456.00,268.00\n" +
                    "             456.00,268.00 454.00,268.00 454.00,268.00 Z");

            materialGrade4.setContent("M 212.00,0.00\n" +
                    "           C 212.00,0.00 285.00,0.00 285.00,0.00\n" +
                    "             285.00,0.00 534.00,0.00 534.00,0.00\n" +
                    "             535.82,0.00 539.06,-0.14 540.68,0.57\n" +
                    "             544.18,2.11 549.97,13.32 552.20,17.00\n" +
                    "             552.20,17.00 581.80,65.00 581.80,65.00\n" +
                    "             581.80,65.00 681.60,228.00 681.60,228.00\n" +
                    "             681.60,228.00 708.68,272.00 708.68,272.00\n" +
                    "             711.04,275.74 720.00,289.56 720.48,293.00\n" +
                    "             721.08,297.33 714.20,307.04 711.80,311.00\n" +
                    "             711.80,311.00 684.05,356.00 684.05,356.00\n" +
                    "             684.05,356.00 579.95,526.00 579.95,526.00\n" +
                    "             579.95,526.00 551.60,572.00 551.60,572.00\n" +
                    "             549.48,575.52 544.05,585.95 540.68,587.43\n" +
                    "             539.06,588.14 535.82,588.00 534.00,588.00\n" +
                    "             534.00,588.00 187.00,588.00 187.00,588.00\n" +
                    "             184.76,588.00 181.44,588.24 179.53,587.01\n" +
                    "             177.42,585.65 174.60,580.31 173.19,578.00\n" +
                    "             173.19,578.00 160.20,557.00 160.20,557.00\n" +
                    "             160.20,557.00 98.32,456.00 98.32,456.00\n" +
                    "             98.32,456.00 26.58,339.00 26.58,339.00\n" +
                    "             26.58,339.00 7.58,308.00 7.58,308.00\n" +
                    "             5.52,304.70 0.44,297.73 0.44,294.00\n" +
                    "             0.44,290.15 9.89,276.08 12.42,272.00\n" +
                    "             12.42,272.00 44.40,220.00 44.40,220.00\n" +
                    "             44.40,220.00 137.58,68.00 137.58,68.00\n" +
                    "             137.58,68.00 165.19,23.00 165.19,23.00\n" +
                    "             168.37,17.81 175.73,4.57 179.53,0.99\n" +
                    "             184.51,-0.97 205.30,0.00 212.00,0.00 Z\n" +
                    "           M 193.32,56.00\n" +
                    "           C 193.32,56.00 169.95,94.00 169.95,94.00\n" +
                    "             169.95,94.00 84.05,234.00 84.05,234.00\n" +
                    "             84.05,234.00 57.68,277.00 57.68,277.00\n" +
                    "             55.25,280.86 48.24,290.71 48.86,295.00\n" +
                    "             49.26,297.79 54.68,306.19 56.42,309.00\n" +
                    "             56.42,309.00 73.68,337.00 73.68,337.00\n" +
                    "             73.68,337.00 130.80,430.00 130.80,430.00\n" +
                    "             130.80,430.00 185.81,520.00 185.81,520.00\n" +
                    "             185.81,520.00 197.00,538.00 197.00,538.00\n" +
                    "             198.42,540.36 201.18,545.61 203.38,546.98\n" +
                    "             205.37,548.22 208.69,548.00 211.00,548.00\n" +
                    "             211.00,548.00 510.00,548.00 510.00,548.00\n" +
                    "             519.45,547.98 518.61,547.23 526.60,534.00\n" +
                    "             526.60,534.00 546.81,501.00 546.81,501.00\n" +
                    "             546.81,501.00 640.19,349.00 640.19,349.00\n" +
                    "             640.19,349.00 665.20,308.00 665.20,308.00\n" +
                    "             667.58,304.03 673.48,296.57 672.11,292.00\n" +
                    "             672.11,292.00 659.80,271.00 659.80,271.00\n" +
                    "             659.80,271.00 632.05,226.00 632.05,226.00\n" +
                    "             632.05,226.00 594.19,164.00 594.19,164.00\n" +
                    "             594.19,164.00 553.00,97.00 553.00,97.00\n" +
                    "             553.00,97.00 526.68,54.00 526.68,54.00\n" +
                    "             517.96,40.16 519.46,40.02 510.00,40.00\n" +
                    "             510.00,40.00 303.00,40.00 303.00,40.00\n" +
                    "             303.00,40.00 237.00,40.00 237.00,40.00\n" +
                    "             237.00,40.00 204.21,40.60 204.21,40.60\n" +
                    "             199.60,43.65 196.33,51.23 193.32,56.00 Z\n" +
                    "           M 394.71,83.00\n" +
                    "           C 394.71,83.00 408.71,131.00 408.71,131.00\n" +
                    "             408.71,131.00 413.86,149.00 413.86,149.00\n" +
                    "             414.48,151.21 415.77,154.79 415.22,157.00\n" +
                    "             414.30,160.70 403.23,170.77 400.00,174.00\n" +
                    "             400.00,174.00 362.00,212.00 362.00,212.00\n" +
                    "             362.00,212.00 382.00,211.00 382.00,211.00\n" +
                    "             382.00,211.00 400.00,210.00 400.00,210.00\n" +
                    "             400.00,210.00 417.00,209.00 417.00,209.00\n" +
                    "             417.00,209.00 435.00,208.00 435.00,208.00\n" +
                    "             435.00,208.00 462.00,207.00 462.00,207.00\n" +
                    "             462.00,207.00 475.00,206.00 475.00,206.00\n" +
                    "             477.77,205.97 484.70,205.75 487.00,206.60\n" +
                    "             491.97,208.43 506.15,225.12 511.00,230.00\n" +
                    "             511.00,230.00 522.04,242.00 522.04,242.00\n" +
                    "             522.04,242.00 568.09,291.00 568.09,291.00\n" +
                    "             574.18,297.54 591.48,314.44 595.00,321.00\n" +
                    "             595.00,321.00 567.00,329.42 567.00,329.42\n" +
                    "             567.00,329.42 524.00,342.00 524.00,342.00\n" +
                    "             524.00,342.00 507.00,346.98 507.00,346.98\n" +
                    "             507.00,346.98 497.00,348.36 497.00,348.36\n" +
                    "             497.00,348.36 480.00,333.00 480.00,333.00\n" +
                    "             480.00,333.00 443.00,296.00 443.00,296.00\n" +
                    "             443.00,296.00 444.00,323.00 444.00,323.00\n" +
                    "             444.00,323.00 445.00,342.00 445.00,342.00\n" +
                    "             445.00,342.00 446.00,357.00 446.00,357.00\n" +
                    "             446.00,357.00 447.00,382.00 447.00,382.00\n" +
                    "             447.00,382.00 447.99,396.00 447.99,396.00\n" +
                    "             447.99,396.00 447.99,421.00 447.99,421.00\n" +
                    "             447.99,421.00 438.00,431.99 438.00,431.99\n" +
                    "             438.00,431.99 414.00,454.17 414.00,454.17\n" +
                    "             414.00,454.17 387.00,479.91 387.00,479.91\n" +
                    "             387.00,479.91 363.00,502.04 363.00,502.04\n" +
                    "             363.00,502.04 333.00,529.00 333.00,529.00\n" +
                    "             333.00,529.00 326.42,505.00 326.42,505.00\n" +
                    "             326.42,505.00 313.00,459.00 313.00,459.00\n" +
                    "             313.00,459.00 307.58,440.00 307.58,440.00\n" +
                    "             306.90,437.62 305.37,433.36 305.90,431.00\n" +
                    "             306.76,427.17 316.82,418.18 320.00,415.00\n" +
                    "             320.00,415.00 359.00,376.00 359.00,376.00\n" +
                    "             359.00,376.00 322.00,378.00 322.00,378.00\n" +
                    "             322.00,378.00 306.00,379.00 306.00,379.00\n" +
                    "             306.00,379.00 281.00,380.00 281.00,380.00\n" +
                    "             281.00,380.00 267.00,381.04 267.00,381.04\n" +
                    "             267.00,381.04 257.00,381.04 257.00,381.04\n" +
                    "             257.00,381.04 247.00,382.00 247.00,382.00\n" +
                    "             247.00,382.00 234.00,381.40 234.00,381.40\n" +
                    "             234.00,381.40 224.04,373.00 224.04,373.00\n" +
                    "             224.04,373.00 206.42,354.00 206.42,354.00\n" +
                    "             206.42,354.00 177.09,323.00 177.09,323.00\n" +
                    "             177.09,323.00 154.99,299.00 154.99,299.00\n" +
                    "             154.99,299.00 126.00,267.00 126.00,267.00\n" +
                    "             126.00,267.00 145.00,261.28 145.00,261.28\n" +
                    "             145.00,261.28 196.00,246.34 196.00,246.34\n" +
                    "             196.00,246.34 215.00,240.86 215.00,240.86\n" +
                    "             215.00,240.86 224.00,239.64 224.00,239.64\n" +
                    "             224.00,239.64 241.00,255.00 241.00,255.00\n" +
                    "             241.00,255.00 278.00,292.00 278.00,292.00\n" +
                    "             278.00,292.00 277.00,263.00 277.00,263.00\n" +
                    "             277.00,263.00 276.00,244.00 276.00,244.00\n" +
                    "             276.00,244.00 275.00,229.00 275.00,229.00\n" +
                    "             275.00,229.00 274.00,203.00 274.00,203.00\n" +
                    "             274.00,203.00 273.00,189.00 273.00,189.00\n" +
                    "             273.00,189.00 272.17,173.00 272.17,173.00\n" +
                    "             271.63,165.92 276.19,162.57 281.00,158.09\n" +
                    "             281.00,158.09 306.00,134.99 306.00,134.99\n" +
                    "             306.00,134.99 337.00,105.91 337.00,105.91\n" +
                    "             337.00,105.91 387.00,59.00 387.00,59.00\n" +
                    "             389.29,62.86 393.21,77.78 394.71,83.00 Z\n" +
                    "           M 324.00,249.00\n" +
                    "           C 324.00,249.00 307.04,266.00 307.04,266.00\n" +
                    "             307.04,266.00 298.97,274.96 298.97,274.96\n" +
                    "             298.97,274.96 280.00,295.00 280.00,295.00\n" +
                    "             280.00,295.00 315.00,330.00 315.00,330.00\n" +
                    "             315.00,330.00 340.00,354.28 340.00,354.28\n" +
                    "             340.00,354.28 353.00,367.04 353.00,367.04\n" +
                    "             354.63,368.60 357.87,372.13 360.00,372.66\n" +
                    "             362.48,373.28 364.31,371.45 366.00,369.94\n" +
                    "             366.00,369.94 379.00,357.00 379.00,357.00\n" +
                    "             379.00,357.00 426.00,310.00 426.00,310.00\n" +
                    "             429.01,306.99 440.69,297.09 439.66,293.00\n" +
                    "             439.10,290.73 434.74,286.74 433.00,285.00\n" +
                    "             433.00,285.00 418.00,270.00 418.00,270.00\n" +
                    "             418.00,270.00 361.00,213.00 361.00,213.00\n" +
                    "             361.00,213.00 324.00,249.00 324.00,249.00 Z");

            materialGrade5.setContent("M 213.00,0.00\n" +
                    "           C 213.00,0.00 236.00,0.00 236.00,0.00\n" +
                    "             236.00,0.00 316.00,0.00 316.00,0.00\n" +
                    "             316.00,0.00 589.00,0.00 589.00,0.00\n" +
                    "             590.91,0.00 594.10,-0.12 595.82,0.60\n" +
                    "             599.27,2.05 606.12,14.30 608.42,18.00\n" +
                    "             608.42,18.00 642.05,72.00 642.05,72.00\n" +
                    "             642.05,72.00 751.42,248.00 751.42,248.00\n" +
                    "             751.42,248.00 782.00,297.00 782.00,297.00\n" +
                    "             784.61,301.01 795.99,318.58 796.48,322.00\n" +
                    "             797.19,326.86 789.16,337.60 786.42,342.00\n" +
                    "             786.42,342.00 755.34,392.00 755.34,392.00\n" +
                    "             755.34,392.00 717.58,453.00 717.58,453.00\n" +
                    "             717.58,453.00 639.81,578.00 639.81,578.00\n" +
                    "             639.81,578.00 607.60,630.00 607.60,630.00\n" +
                    "             605.38,633.69 599.37,644.91 595.82,646.40\n" +
                    "             594.10,647.12 590.91,647.00 589.00,647.00\n" +
                    "             589.00,647.00 208.00,647.00 208.00,647.00\n" +
                    "             205.69,647.00 202.37,647.22 200.38,645.98\n" +
                    "             198.08,644.54 194.15,637.57 192.60,635.00\n" +
                    "             192.60,635.00 177.81,611.00 177.81,611.00\n" +
                    "             177.81,611.00 107.00,497.00 107.00,497.00\n" +
                    "             107.00,497.00 29.40,372.00 29.40,372.00\n" +
                    "             29.40,372.00 8.95,339.00 8.95,339.00\n" +
                    "             7.01,335.89 0.95,327.07 0.52,324.00\n" +
                    "             -0.13,319.39 9.28,306.41 12.05,302.00\n" +
                    "             12.05,302.00 47.58,245.00 47.58,245.00\n" +
                    "             47.58,245.00 150.19,80.00 150.19,80.00\n" +
                    "             150.19,80.00 183.68,26.00 183.68,26.00\n" +
                    "             187.44,20.04 195.89,5.10 200.38,1.02\n" +
                    "             204.36,-0.51 208.77,0.00 213.00,0.00 Z\n" +
                    "           M 76.05,343.00\n" +
                    "           C 76.05,343.00 103.42,387.00 103.42,387.00\n" +
                    "             103.42,387.00 191.68,529.00 191.68,529.00\n" +
                    "             191.68,529.00 221.58,577.00 221.58,577.00\n" +
                    "             223.65,580.34 229.25,591.00 232.38,592.43\n" +
                    "             233.94,593.14 237.23,593.00 239.00,593.00\n" +
                    "             239.00,593.00 558.00,593.00 558.00,593.00\n" +
                    "             560.24,593.00 563.56,593.24 565.47,592.01\n" +
                    "             567.51,590.69 571.72,583.40 573.19,581.00\n" +
                    "             573.19,581.00 588.68,556.00 588.68,556.00\n" +
                    "             588.68,556.00 662.60,437.00 662.60,437.00\n" +
                    "             662.60,437.00 715.42,352.00 715.42,352.00\n" +
                    "             715.42,352.00 727.95,332.00 727.95,332.00\n" +
                    "             729.74,329.13 732.55,325.56 731.71,322.00\n" +
                    "             731.71,322.00 719.20,301.00 719.20,301.00\n" +
                    "             719.20,301.00 688.69,252.00 688.69,252.00\n" +
                    "             688.69,252.00 669.58,221.00 669.58,221.00\n" +
                    "             669.58,221.00 602.95,114.00 602.95,114.00\n" +
                    "             602.95,114.00 575.60,70.00 575.60,70.00\n" +
                    "             573.59,66.66 567.79,55.95 564.67,54.57\n" +
                    "             563.07,53.86 559.81,54.00 558.00,54.00\n" +
                    "             558.00,54.00 239.00,54.00 239.00,54.00\n" +
                    "             237.23,54.00 233.94,53.86 232.38,54.57\n" +
                    "             229.25,56.00 223.65,66.66 221.58,70.00\n" +
                    "             221.58,70.00 192.32,117.00 192.32,117.00\n" +
                    "             192.32,117.00 111.58,247.00 111.58,247.00\n" +
                    "             111.58,247.00 82.95,293.00 82.95,293.00\n" +
                    "             82.95,293.00 64.00,324.00 64.00,324.00\n" +
                    "             64.00,324.00 76.05,343.00 76.05,343.00 Z\n" +
                    "           M 330.85,229.00\n" +
                    "           C 330.85,229.00 342.86,185.00 342.86,185.00\n" +
                    "             342.86,185.00 347.85,167.00 347.85,167.00\n" +
                    "             347.85,167.00 350.85,158.39 350.85,158.39\n" +
                    "             350.85,158.39 365.00,150.69 365.00,150.69\n" +
                    "             365.00,150.69 396.00,136.14 396.00,136.14\n" +
                    "             396.00,136.14 474.00,99.69 474.00,99.69\n" +
                    "             474.00,99.69 509.00,84.00 509.00,84.00\n" +
                    "             509.00,84.00 508.00,101.00 508.00,101.00\n" +
                    "             508.00,101.00 506.00,183.00 506.00,183.00\n" +
                    "             506.00,183.00 504.01,197.37 504.01,197.37\n" +
                    "             504.01,197.37 488.00,206.58 488.00,206.58\n" +
                    "             488.00,206.58 442.00,230.00 442.00,230.00\n" +
                    "             442.00,230.00 464.00,229.00 464.00,229.00\n" +
                    "             464.00,229.00 511.00,227.00 511.00,227.00\n" +
                    "             511.00,227.00 526.00,226.00 526.00,226.00\n" +
                    "             526.00,226.00 541.00,227.02 541.00,227.02\n" +
                    "             541.00,227.02 551.17,237.00 551.17,237.00\n" +
                    "             551.17,237.00 569.01,256.00 569.01,256.00\n" +
                    "             569.01,256.00 624.09,315.00 624.09,315.00\n" +
                    "             624.09,315.00 659.00,353.00 659.00,353.00\n" +
                    "             659.00,353.00 603.00,369.72 603.00,369.72\n" +
                    "             603.00,369.72 549.00,385.00 549.00,385.00\n" +
                    "             549.00,385.00 524.09,359.83 524.09,359.83\n" +
                    "             524.09,359.83 500.00,335.00 500.00,335.00\n" +
                    "             500.00,335.00 525.34,403.00 525.34,403.00\n" +
                    "             525.34,403.00 533.46,426.00 533.46,426.00\n" +
                    "             533.46,426.00 527.14,440.00 527.14,440.00\n" +
                    "             527.14,440.00 510.00,471.00 510.00,471.00\n" +
                    "             510.00,471.00 467.86,547.00 467.86,547.00\n" +
                    "             467.86,547.00 450.00,579.00 450.00,579.00\n" +
                    "             444.49,574.34 436.05,560.56 431.67,554.00\n" +
                    "             431.67,554.00 401.67,510.00 401.67,510.00\n" +
                    "             401.67,510.00 390.67,494.00 390.67,494.00\n" +
                    "             389.02,491.53 386.42,488.06 386.49,485.00\n" +
                    "             386.56,482.16 393.08,470.34 394.75,467.00\n" +
                    "             394.75,467.00 408.26,440.00 408.26,440.00\n" +
                    "             408.26,440.00 417.00,423.00 417.00,423.00\n" +
                    "             417.00,423.00 364.00,465.20 364.00,465.20\n" +
                    "             364.00,465.20 341.00,482.45 341.00,482.45\n" +
                    "             341.00,482.45 325.00,480.20 325.00,480.20\n" +
                    "             325.00,480.20 291.00,473.60 291.00,473.60\n" +
                    "             291.00,473.60 205.00,457.00 205.00,457.00\n" +
                    "             205.00,457.00 170.00,450.00 170.00,450.00\n" +
                    "             170.00,450.00 189.00,424.00 189.00,424.00\n" +
                    "             189.00,424.00 221.42,382.00 221.42,382.00\n" +
                    "             221.42,382.00 233.87,366.00 233.87,366.00\n" +
                    "             233.87,366.00 240.17,360.46 240.17,360.46\n" +
                    "             240.17,360.46 257.00,362.92 257.00,362.92\n" +
                    "             257.00,362.92 291.00,368.27 291.00,368.27\n" +
                    "             291.00,368.27 309.00,370.00 309.00,370.00\n" +
                    "             309.00,370.00 291.00,359.05 291.00,359.05\n" +
                    "             291.00,359.05 251.00,332.95 251.00,332.95\n" +
                    "             251.00,332.95 236.00,323.00 236.00,323.00\n" +
                    "             236.00,323.00 228.02,316.68 228.02,316.68\n" +
                    "             228.02,316.68 225.58,302.00 225.58,302.00\n" +
                    "             225.58,302.00 220.85,264.00 220.85,264.00\n" +
                    "             220.85,264.00 210.85,183.00 210.85,183.00\n" +
                    "             210.85,183.00 206.00,144.00 206.00,144.00\n" +
                    "             206.00,144.00 231.00,152.31 231.00,152.31\n" +
                    "             231.00,152.31 285.00,171.66 285.00,171.66\n" +
                    "             285.00,171.66 305.00,178.81 305.00,178.81\n" +
                    "             305.00,178.81 312.69,183.27 312.69,183.27\n" +
                    "             312.69,183.27 316.42,203.00 316.42,203.00\n" +
                    "             316.42,203.00 325.00,253.00 325.00,253.00\n" +
                    "             325.00,253.00 330.85,229.00 330.85,229.00 Z\n" +
                    "           M 390.00,255.75\n" +
                    "           C 390.00,255.75 350.00,276.25 350.00,276.25\n" +
                    "             346.31,278.09 331.96,284.33 330.58,287.39\n" +
                    "             329.52,289.74 330.82,295.37 331.25,298.00\n" +
                    "             331.25,298.00 335.13,323.00 335.13,323.00\n" +
                    "             335.13,323.00 340.87,359.00 340.87,359.00\n" +
                    "             341.28,361.90 342.67,373.66 344.02,375.44\n" +
                    "             346.15,378.26 360.93,379.58 365.00,380.25\n" +
                    "             365.00,380.25 410.00,387.41 410.00,387.41\n" +
                    "             410.00,387.41 431.81,390.54 431.81,390.54\n" +
                    "             435.29,389.95 437.72,383.89 439.22,381.00\n" +
                    "             439.22,381.00 453.25,353.00 453.25,353.00\n" +
                    "             453.25,353.00 468.25,324.00 468.25,324.00\n" +
                    "             469.51,321.48 473.97,313.29 474.05,311.00\n" +
                    "             474.21,306.47 463.34,297.34 460.00,294.00\n" +
                    "             460.00,294.00 426.00,260.00 426.00,260.00\n" +
                    "             421.68,255.68 415.88,248.14 410.00,246.70\n" +
                    "             404.54,247.67 395.34,253.08 390.00,255.75 Z\n" +
                    "           M 499.00,334.00\n" +
                    "           C 499.00,334.00 500.00,335.00 500.00,335.00\n" +
                    "             500.00,335.00 500.00,334.00 500.00,334.00\n" +
                    "             500.00,334.00 499.00,334.00 499.00,334.00 Z\n" +
                    "           M 417.00,422.00\n" +
                    "           C 417.00,422.00 418.00,423.00 418.00,423.00\n" +
                    "             418.00,423.00 418.00,422.00 418.00,422.00\n" +
                    "             418.00,422.00 417.00,422.00 417.00,422.00 Z");
        }
    }

    /**
     * Callback and Callback producing functions that control how various UI elements are created and displayed
     */
    public static class Data
    {
        static final Callback<TableColumn.CellDataFeatures<ItemCostData, String>, ObservableValue<String>>
                costNeedCellFactory = (modMaterial) ->
        {
            int left = 0;
            int need = modMaterial.getValue().getNeed();
            int have = modMaterial.getValue().getHave();
            boolean ok = need <= have;
            if (!ok)
            {
                left = need - have;
            }

            return new SimpleStringProperty(String.valueOf(left));
        };

        public static final Callback<TableColumn<Pair<ItemEffect, Label>, Label>, TableCell<Pair<ItemEffect, Label>, Label>>
                moduleEffectValueFactory = (param) -> new TableCell<Pair<ItemEffect, Label>, Label>()
        {
            @Override
            protected void updateItem(Label item, boolean empty)
            {
                super.updateItem(item, empty);
                if (item == null || empty) setGraphic(null);
                else
                {
                    setAlignment(Pos.CENTER_RIGHT);
                    item.setPadding(new Insets(0,5,0,0));
                    setGraphic(item);
                }
            }
        };

        public static final Callback<TableColumn<Pair<ItemEffect, Label>, Label>, TableCell<Pair<ItemEffect, Label>, Label>>
                moduleEffectUnitFactory = (param) -> new TableCell<Pair<ItemEffect, Label>, Label>()
        {
            @Override
            protected void updateItem(Label item, boolean empty)
            {
                super.updateItem(item, empty);
                if (item == null || empty) setGraphic(null);
                else
                {
                    setAlignment(Pos.CENTER_LEFT);
                    setGraphic(item);
                }
            }
        };


        public static final Callback<TableColumn<Pair<ItemEffect, Label>, Pair<ItemEffect, Label>>, TableCell<Pair<ItemEffect, Label>, Pair<ItemEffect, Label>>>
                moduleNameCellFactory = (param) -> new TableCell<Pair<ItemEffect, Label>, Pair<ItemEffect, Label>>()
        {
            @Override
            protected void updateItem(Pair<ItemEffect, Label> item, boolean empty)
            {
                super.updateItem(item, empty);
                if (item == null || empty)
                {
                    setGraphic(null);
                    return;
                }
                Label name = new Label(item.getKey().toString());
                name.setFont(Fonts.size2Font);
                name.setPadding(new Insets(0,0,0,5));
                setGraphic(name);
            }
        };



        /**
         * Standard mathematical range mapping function. Accepts a number within a given range and maps it to a
         * corresponding value in a different range.
         *
         * @param input the numerical value to map from the input range to the output range
         * @param inputMin low end of the input range, the s parameter should be greater than or equal to this value
         * @param inputMax high end of the input range, the s parameter should be less than or equal to this value
         * @param outputMin low end of the output range, the return value will be greater than or equal to this value
         * @param outputMax high end of the output range, the return value will be less than or equal to this value
         * @return the result of applying the mapping function on the inputValue from the input range to the output range
         */
        public static double mapRange(double input, double inputMin, double inputMax, double outputMin, double outputMax)
        {
            return outputMin + ((input - inputMin) * (outputMax - outputMin)) / (inputMax - inputMin);
        }

        /**
         * Rounding function for double values. Uses an intermediate BigDecimal object to round (not truncate)
         *
         * @param value double value to round
         * @param precision number of digits to round to
         * @return the input value, rounded tot he desired precision
         */
        public static double round(double value, int precision)
        {
            if (precision < 0) return value;
            BigDecimal decimal = new BigDecimal(value);
            decimal = decimal.setScale(precision, RoundingMode.HALF_UP);
            return decimal.doubleValue();
        }
    }

    /**
     * Mapping functions used to produce UI elements from other data objects
     */
    public static class Convert
    {

        public static Region createMaterialIconRegion(SVGPath svg, double width, double height)
        {
            final Region svgShape = new Region();
            svgShape.setShape(svg);

            svgShape.setMinSize(width, height);
            svgShape.setPrefSize(width, height);
            svgShape.setMaxSize(width, height);
            svgShape.setStyle("-fx-background-color: #b75200;");
            double originalWidth = svg.prefWidth(-1);
            double originalHeight = svg.prefHeight(originalWidth);

            double scaleX = width / originalWidth;
            double scaleY = height / originalHeight;

            svg.setScaleX(scaleX);
            svg.setScaleY(scaleY);
            return svgShape;
        }

        // Creates a Label object from a Pair<ItemEffect, Double>. The provided pair represents the effect that some
        // modification or experimental effect would have on whatever item it is applied to, and the magnitude of that
        // effect. If the magnitude is a positive number, it would be added to the base value of any modified item, and
        // likewise, a negative value would become a subtraction from any base value.
        public static Function<ItemEffectData, Label> effectToLabel = (pair) ->
        {
            Label nextLabel = new Label();

            // todo: in the future this will be done with CSS
            nextLabel.setFont(Fonts.size1Font);

            // get the "more is good" flag for this effect
            boolean moreIsGood = pair.getEffect().isMoreGood();

            boolean isNumerical = pair.isNumerical();

            if (isNumerical)
            {
                // set a flag to capture whether the value is negative or positive
                boolean valueIsPositive = pair.getDoubleValue() >= 0;

                // now set a flag marking this effect as "good" or "bad". This is used primarily to add a corresponding
                // color to the UI indicating good/bad status. For example, "bad" effects are often displayed in red
                boolean isGood = moreIsGood == valueIsPositive;

                // we want positive changes to have a plus sign (+) in their text. Negative values have a minus sign (-)
                // prefix by default, so we only need to explicitly do this for positive numbers

                String text = pair.getEffect().toString()
                        + (valueIsPositive ? " +" : " ")
                        + String.valueOf(pair.getDoubleValue()) ;

                // some effects have a zero value, such effects are generally "binary" on/off values, so we can just remove
                // the trailing "point zero" suffix
                text = text.replace(".0","");

                // todo: clean this up, there's extra checks here
                // to make the text match the in game values, add a percent sign (%)
                if (text.contains("-") || text.contains("+")) text += "%";
                text = text.replace("+0%","");

                // now create the label object using the text we just created
                //nextLabel = new Label(text);

                nextLabel.setText(text);


                // text fill is a separate value, set it to the "good" or "bad" font as appropriate
                nextLabel.setTextFill(isGood ? Fonts.positiveBlue : Fonts.negativeRed);
            }
            else
            {
                nextLabel.setText(pair.getEffect().toString() + " " + pair.getStringValue());
            }

            return nextLabel;
        };
    }

    /**
     * Comparators, used when sorting data sets in various ways
     */
    public static class Sort
    {
        // sort Label objects by "good/bad status" where blue is good and red is bad. Good comes before bad
        public static final Comparator<Label> byGoodness = (a, b) -> a.getTextFill() == b.getTextFill()
                ? 0
                : a.getTextFill() == Color.BLUE
                        ? -1
                        : 1;

        // sort InventoryData objects by category ordinal
        static final Comparator<InventoryData> itemByCategory =
                Comparator.comparingInt(InventoryData::getCategoryOrdinal);

        // sort InventoryData objects by grade, lowest to highest
        static final Comparator<InventoryData> itemByGrade =
                Comparator.comparingInt(InventoryData::getGradeOrdinal);

        // sort InventoryData objects numerically by count, highest to lowest
        static final Comparator<InventoryData> itemByCount =
                Comparator.comparingInt(InventoryData::getQuantity).reversed();

        // used for Label objects that are actually just string representations of Integer values. Will sort them
        // numerically lowest to highest
        static final Comparator<Label> quantityByNumericValue =
                Comparator.comparingInt(a -> {
                    try
                    {
                        return Integer.parseInt(a.getText().trim());
                    }
                    catch (Exception e)
                    {
                        int slashIndex = a.getText().indexOf("/");
                        String stripped = a.getText().substring(0, slashIndex).trim();
                        return Integer.parseInt(stripped);
                    }
                });

        static final Comparator<ProgressBar> progressByValue =
                Comparator.comparingDouble(ProgressIndicator::getProgress);

        // sorts procurement tasks by name, and ensure trade tasks always come after all other task types
        static final Comparator<ProcurementTaskData> tasksByName =
                (a, b)->
                {
                    if (a.isTrade() != b.isTrade())
                    {
                        return a.isTrade() ? 1 : -1;
                    }

                    String as = a.asPair().getKey().toString() + a.asPair().getValue().toString();
                    String bs = b.asPair().getKey().toString() + b.asPair().getValue().toString();
                    return as.compareTo(bs);
                };

        // sorts procurement tasks by grade, and ensure trade tasks always come after all other task types
        static final Comparator<ProcurementTaskData> taskByGrade =
                (a, b) ->
                {
                    if (a.isTrade() != b.isTrade())
                    {
                        return a.isTrade() ? 1 : -1;
                    }

                    return ItemGrade.compare(a.asPair().getValue().getGrade(), b.asPair().getValue().getGrade());
                };

        // trade costs sorted by absolute need, with highest need always sorted first
        static final Comparator<ItemCostData> costsByNeed =
                (a, b)->
                {
                    int aNeed = a.getNeed();
                    int bNeed = b.getNeed();
                    int aHave = a.getHave();
                    int bHave = b.getHave();
                    boolean aok = aHave >= aNeed;
                    boolean bok = bHave >= bNeed;

                    int r2;

                    if (aok && bok) r2 = 0;
                    else if (aok || bok) r2 = aok ? 1 : -1;
                    else
                    {
                        int aDiff = Math.abs(aNeed - aHave);
                        int bDiff = Math.abs(bNeed - bHave);
                        r2 = bDiff - aDiff;
                    }

                    return r2;
                };

        // trade task by best cost/yield ratio
        public static final Comparator<ProcurementRecipe> bestCostYieldRatio =
                (a, b)->
                {
                    int aCost = a.costStream().filter(c -> c.getQuantity() > 0)
                            .mapToInt(CostData::getQuantity).sum();

                    int bCost = b.costStream().filter(c -> c.getQuantity() > 0)
                            .mapToInt(CostData::getQuantity).sum();

                    int aYield = a.costStream().filter(c -> c.getQuantity() < 0)
                            .mapToInt(CostData::getQuantity)
                            .map(Math::abs)
                            .sum();

                    int bYield = b.costStream().filter(c -> c.getQuantity() < 0)
                            .mapToInt(CostData::getQuantity)
                            .map(Math::abs)
                            .sum();

                    if (aCost == bCost) return bYield - aYield;

                    return aCost - bCost;
                };
    }
}
